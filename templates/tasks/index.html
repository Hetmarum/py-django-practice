{% extends "base.html" %}

{% block content %}
  <h1>TODO list <a class="btn btn-primary" style="float: right" href="{% url 'tasks:task-create' %}">Add task</a></h1>

   {% if task_list %}
    <ul class="list-group">
      {% for task in task_list %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <strong>{{ task.content }}</strong>
            {% if task.is_done %}
              <span class="text-success"><strong>Done</strong></span>
            {% else %}
              <span class="text-danger"><strong>Not done</strong></span>
            {% endif %}

            <div class="text-muted small">
              Created: {{ task.created_at|date:"F j, Y, g:i a" }}
              {% if task.deadline %}
                <span class="text-danger"><strong>Deadline: {{ task.deadline|date:"F j, Y, g:i a" }}</strong></span>
              {% endif %}
            </div>

            <div>
              Tags:
              {% for tag in task.tags.all %}
                <span>{{ tag.name }}</span>
              {% empty %}
                <span class="text-muted">No tags</span>
              {% endfor %}
              <a class="btn btn-link btn-sm" href="{% url 'tasks:task-update' task.id %}"><strong>Update</strong></a>
              <a class="btn btn-link btn-sm" href="{% url 'tasks:task-delete' task.id %}"><strong>Delete</strong></a>
            </div>
          </div>

          <div>
            <form method="post" action="{% url 'tasks:task-toggle' task.id %}">
              {% csrf_token %}
              {% if task.is_done %}
                <button class="btn btn-secondary btn-sm" type="submit">Undo</button>
              {% else %}
                <button class="btn btn-success btn-sm" type="submit">Complete</button>
              {% endif %}
            </form>
          </div>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No tasks yet.</p>
  {% endif %}
{% endblock %}
